- name: install service packages
  yum:
    name:
      - "{{ item }}"
  with_items: "{{ packages }}"

- name: "is selinux already installed"
  shell: rpm -q selinux-policy
  register: selinux
  failed_when: selinux.rc not in [0, 1]
- name: "disable selinux"
  selinux:
    state: "disabled"
  when: selinux.rc == 0

- name: "/etc/cron.d/sysstat"
  copy:
    src: "sysstat"
    dest: "/etc/cron.d/sysstat"

- name: "check if firewalld is running"
  command: systemctl is-active firewalld
  register: firewalld_result
  changed_when: False
  failed_when: firewalld_result.rc not in [0, 3]
- name: "disable service firewalld"
  systemd:
    name: "firewalld"
    state: "stopped"
    enabled: "no"
  when: firewalld_result.stdout == "active"

- name: "history size, format"
  copy:
    src: history.sh
    dest: /etc/profile.d/history.sh

- name: set timezone
  shell: timedatectl set-timezone {{ zone }}
  register: set_timezone
  changed_when: false
  check_mode: no

- name: set loclale
  shell: localectl set-locale LANG={{ locale }}
  register: set_locale
  changed_when: false
  check_mode: no
